# 产品需求文档：飞机大战游戏功能

## 1. 概述

### 问题陈述
KET 备考系统需要增加趣味性和互动性，让小学生在学习之余能够放松娱乐，提高系统的用户粘性和使用频率。

### 解决方案描述
在主页添加一个简单有趣的飞机大战游戏，使用 Canvas 实现流畅的游戏体验。游戏风格适合小学生，操作简单，色彩鲜艳，能够在学习间隙提供轻松的娱乐。

### 成功指标
- 游戏加载时间 < 2 秒
- 游戏帧率稳定在 60fps
- 用户平均游戏时长 > 3 分钟
- 游戏重玩率 > 50%

## 2. 用户故事

### US-1: 游戏入口
**作为** 小学生用户
**我想** 在主页上看到游戏入口按钮
**以便** 快速开始游戏

**验收标准**：
- [ ] 主页显示"飞机大战"游戏入口按钮
- [ ] 按钮样式醒目，适合小学生审美
- [ ] 点击按钮打开游戏界面

### US-2: 游戏操作
**作为** 小学生玩家
**我想** 使用简单的操作控制飞机
**以便** 轻松上手游戏

**验收标准**：
- [ ] 支持键盘方向键（←→）控制飞机左右移动
- [ ] 支持鼠标移动控制飞机位置
- [ ] 飞机自动发射子弹
- [ ] 操作响应流畅，无延迟

### US-3: 游戏玩法
**作为** 小学生玩家
**我想** 击落敌机获得分数
**以便** 挑战更高分数

**验收标准**：
- [ ] 敌机从屏幕上方随机位置出现
- [ ] 敌机以不同速度向下移动
- [ ] 子弹击中敌机，敌机消失，得分增加
- [ ] 敌机撞到玩家飞机，游戏结束
- [ ] 实时显示当前分数

### US-4: 游戏状态
**作为** 小学生玩家
**我想** 看到游戏状态和控制按钮
**以便** 管理游戏进程

**验收标准**：
- [ ] 显示"开始游戏"按钮
- [ ] 游戏中显示"暂停"按钮
- [ ] 游戏结束显示"重新开始"按钮
- [ ] 显示当前分数和最高分

### US-5: 最高分记录
**作为** 小学生玩家
**我想** 看到我的最高分记录
**以便** 挑战自己的最好成绩

**验收标准**：
- [ ] 游戏结束后保存最高分到本地存储
- [ ] 游戏界面显示历史最高分
- [ ] 打破最高分时显示祝贺动画

## 3. 功能需求

### 3.1 游戏界面
- **游戏画布**：800x600 像素的 Canvas 画布
- **背景**：蓝天白云的卡通风格背景
- **UI 元素**：分数显示、最高分显示、控制按钮

### 3.2 游戏元素

#### 玩家飞机
- 位置：画布底部中央
- 移动范围：画布左右边界内
- 移动速度：5 像素/帧
- 外观：可爱的卡通飞机（蓝色）
- 尺寸：60x60 像素

#### 敌机
- 类型：3 种不同类型
  - 小型敌机：速度快，分数 10
  - 中型敌机：速度中等，分数 20
  - 大型敌机：速度慢，分数 50
- 生成频率：每 1-2 秒生成一架
- 生成位置：画布顶部随机 X 坐标
- 移动方向：垂直向下

#### 子弹
- 发射频率：每 0.3 秒自动发射
- 发射位置：玩家飞机顶部中央
- 移动速度：8 像素/帧
- 外观：黄色圆形子弹
- 尺寸：8x16 像素

### 3.3 游戏逻辑

#### 碰撞检测
- 子弹与敌机碰撞：敌机消失，子弹消失，分数增加
- 玩家飞机与敌机碰撞：游戏结束
- 边界检测：飞机不能移出画布边界

#### 游戏状态
- **未开始**：显示开始按钮和游戏说明
- **进行中**：游戏运行，显示暂停按钮
- **暂停**：游戏暂停，显示继续按钮
- **结束**：显示最终分数和重新开始按钮

#### 难度递增
- 每得 100 分，敌机生成频率增加 10%
- 最高难度：敌机生成间隔 0.5 秒

### 3.4 视觉效果
- 爆炸动画：敌机被击中时显示爆炸效果
- 粒子效果：子弹发射时的火花效果
- 得分动画：击中敌机时显示 "+10" 浮动文字
- 游戏结束动画：屏幕震动效果

## 4. 非功能需求

### 4.1 性能
- 游戏帧率：稳定 60fps
- 内存占用：< 50MB
- 加载时间：< 2 秒
- 响应时间：操作延迟 < 16ms

### 4.2 兼容性
- 浏览器：Chrome 90+, Firefox 88+, Safari 14+
- 屏幕尺寸：最小 1024x768
- 设备：桌面端和平板端

### 4.3 用户体验
- 色彩鲜艳，适合小学生审美
- 操作简单，无需教程即可上手
- 音效可选（可以后续添加）
- 流畅的动画效果

### 4.4 可维护性
- 代码结构清晰，易于扩展
- 添加必要的中文注释
- 遵循项目编码规范
- 游戏逻辑与 UI 分离

## 5. 验收标准

### 5.1 功能验收
- [ ] 游戏可以正常启动和运行
- [ ] 玩家飞机可以左右移动
- [ ] 子弹自动发射并击中敌机
- [ ] 敌机从上方出现并向下移动
- [ ] 碰撞检测准确无误
- [ ] 分数计算正确
- [ ] 最高分保存到本地存储
- [ ] 游戏可以暂停和重新开始

### 5.2 性能验收
- [ ] 游戏帧率稳定在 60fps
- [ ] 无明显卡顿和延迟
- [ ] 内存占用合理
- [ ] 长时间运行无内存泄漏

### 5.3 UI/UX 验收
- [ ] 界面美观，色彩鲜艳
- [ ] 按钮大小适合点击
- [ ] 文字清晰易读
- [ ] 动画流畅自然

### 5.4 代码质量验收
- [ ] 代码结构清晰
- [ ] 添加必要的中文注释
- [ ] 遵循项目编码规范
- [ ] 无安全漏洞

## 6. 技术考虑

### 6.1 前端技术栈
- **框架**：Vue 3 (Composition API)
- **语言**：TypeScript 5.x
- **构建工具**：Vite 5.x
- **状态管理**：Pinia 2.x（可选）
- **样式**：Tailwind CSS 3.x

### 6.2 游戏引擎
- 使用原生 Canvas API
- 不依赖第三方游戏引擎
- 自定义游戏循环（requestAnimationFrame）

### 6.3 数据存储
- 使用 localStorage 保存最高分
- 数据格式：`{ highScore: number, lastPlayTime: string }`

### 6.4 文件结构
```
main/frontend/
├── components/
│   └── PlaneGame.vue          # 游戏主组件
├── utils/
│   ├── gameEngine.ts          # 游戏引擎核心逻辑
│   ├── GameObject.ts          # 游戏对象基类
│   ├── Player.ts              # 玩家飞机类
│   ├── Enemy.ts               # 敌机类
│   ├── Bullet.ts              # 子弹类
│   └── CollisionDetector.ts   # 碰撞检测工具
└── pages/
    └── Home.vue               # 主页（集成游戏入口）
```

### 6.5 API 需求
- 无需后端 API（第一版）
- 可选：后续添加排行榜 API

### 6.6 第三方依赖
- 无需额外依赖
- 使用项目现有依赖即可

## 7. 开发计划

### 阶段 1：核心游戏逻辑（1 天）
- 实现游戏引擎核心循环
- 实现游戏对象类（Player, Enemy, Bullet）
- 实现碰撞检测

### 阶段 2：UI 和交互（0.5 天）
- 实现 Vue 组件
- 实现控制按钮
- 实现分数显示

### 阶段 3：视觉效果（0.5 天）
- 实现爆炸动画
- 实现粒子效果
- 实现得分动画

### 阶段 4：集成和测试（0.5 天）
- 集成到主页
- 测试游戏性能
- 修复 Bug

### 阶段 5：优化和发布（0.5 天）
- 代码审查
- 性能优化
- 文档完善

## 8. 风险和缓解

### 风险 1：性能问题
**描述**：大量游戏对象可能导致帧率下降
**缓解**：
- 限制同时存在的敌机和子弹数量
- 使用对象池复用游戏对象
- 优化碰撞检测算法

### 风险 2：浏览器兼容性
**描述**：不同浏览器的 Canvas 性能差异
**缓解**：
- 在主流浏览器上测试
- 提供降级方案
- 添加浏览器检测

### 风险 3：用户体验
**描述**：游戏难度不适合小学生
**缓解**：
- 设置合理的初始难度
- 提供难度选择（简单/普通/困难）
- 收集用户反馈调整

## 9. 后续优化

### 第二版功能
- 添加音效和背景音乐
- 添加道具系统（护盾、双倍分数）
- 添加更多敌机类型
- 添加 Boss 战

### 第三版功能
- 后端排行榜 API
- 多人对战模式
- 成就系统
- 皮肤系统

## 10. 参考资料

- Vue 3 官方文档：https://vuejs.org/
- Canvas API 文档：https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API
- 游戏开发最佳实践：https://developer.mozilla.org/en-US/docs/Games

---

**文档版本**：v1.0
**创建日期**：2026-01-23
**创建人**：Product Manager Agent
**审核状态**：待审核
