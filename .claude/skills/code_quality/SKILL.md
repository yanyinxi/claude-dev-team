---
name: code-quality
description: 审查代码质量和安全问题。用于代码审查、安全扫描、性能优化、代码规范检查。适用于 PR 审查、代码质量检查、安全漏洞扫描、性能优化建议等场景。
disable-model-invocation: false
user-invocable: true
allowed-tools: Read, Grep, Glob, Bash
context: fork
agent: code-reviewer
---

# 代码质量技能

## 何时使用

当需要以下操作时使用此技能：
- 审查代码质量
- 扫描安全漏洞
- 检查代码规范
- 提供优化建议

## 工作流程

### 第一步：快速扫描
- 使用 grep 查找 TODO、FIXME
- 查找硬编码的值
- 识别危险 API 使用

### 第二步：深度检查
- 逐个检查重点文件
- 检查安全漏洞
- 检查异常处理
- 检查资源管理

### 第三步：生成报告
- 按严重程度分类
- 提供修复建议
- 给出改进意见

## 输出格式

```markdown
# 代码审查报告：[功能名称]

## 审查概览
- 审查文件数：XX
- 发现问题数：XX
- 严重问题：XX
- 重要问题：XX
- 建议：XX

## 问题列表

### 🔴 严重问题（Critical）

| 文件 | 行号 | 问题 | 影响 | 修复建议 |
|------|------|------|------|----------|
| api/user.py | 45 | SQL 注入风险 | 数据泄露 | 使用参数化查询 |

### 🟡 重要问题（Important）

| 文件 | 行号 | 问题 | 影响 | 修复建议 |
|------|------|------|------|----------|
| utils/helper.py | 12 | 硬编码密钥 | 安全风险 | 使用环境变量 |

### 💡 建议（Suggestions）

| 文件 | 行号 | 建议 | 原因 |
|------|------|------|------|
| models/user.py | 8 | 添加 Docstring | 提高可读性 |
```

## 审查维度

1. **正确性**：功能实现是否正确
2. **安全性**：是否存在安全漏洞
3. **性能**：是否存在性能问题
4. **可读性**：代码是否易于理解
5. **可维护性**：代码是否易于维护
6. **规范性**：是否符合编码规范

## 最佳实践

1. **安全优先**：首先检查安全问题
2. **具体明确**：问题描述要具体
3. **提供方案**：给出具体的修复建议
4. **分级处理**：按严重程度分类处理
5. **参考标准**：遵循 project_standards.md 中的规范

## 常见问题检查清单

- [ ] SQL 注入风险
- [ ] XSS 跨站脚本攻击
- [ ] 硬编码的密钥/密码
- [ ] 未处理的异常
- [ ] 资源泄露（文件、连接未关闭）
- [ ] 性能瓶颈（N+1 查询、大循环）
- [ ] 代码重复
- [ ] 命名不规范
- [ ] 缺少注释

## 参考资料

- 参考 @.claude/project_standards.md 的代码规范
- 参考 @main/docs/reviews/ 查看历史审查报告

---

## 📈 进化记录（自动生成）

_此章节由 Evolver 自动更新，记录从实际任务执行中学到的经验和最佳实践。_
